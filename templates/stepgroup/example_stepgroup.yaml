name: Security Scan Steps
description: A set of steps for running security scans on code and containers
type: stepgroup
author: Security Team
version: 2.0.1
tags:
  - security
  - scan
  - compliance

variables:
  scanLevel:
    type: string
    description: Level of scan to perform (basic, standard, deep)
    required: false
  reportPath:
    type: string
    description: Path to save scan reports
    required: true

parameters:
  scanType:
    type: string
    description: Type of scan to perform (code, container, both)
    default: both
    required: true
  failOnHigh:
    type: boolean
    description: Whether to fail the pipeline on high severity findings
    default: true
    required: false

steps:
  - name: Prepare Scan Environment
    description: Set up the environment for security scanning
  - name: Run Code Scan
    description: Scan source code for vulnerabilities
  - name: Run Container Scan
    description: Scan container images for vulnerabilities
  - name: Generate Security Report
    description: Generate a comprehensive security report

examples:
  - |
    # Example usage in a stage
    steps:
      - stepGroup:
          template:
            name: Security Scan Steps
            identifier: security_scan_steps
            versionLabel: 2.0.1
          variables:
            scanLevel: standard
            reportPath: reports/security/
          parameters:
            scanType: container
            failOnHigh: true
