name: Kubernetes Deployment Stage
description: A template for deploying applications to Kubernetes
type: stage
author: Harness Team
version: 1.2.0
tags:
  - kubernetes
  - deployment
  - k8s

stage:
  variables:
    namespace:
      type: string
      description: Kubernetes namespace to deploy to
      required: true
    serviceAccount:
      type: string
      description: Service account to use for deployment
      required: false

  parameters:
    manifests:
      type: string
      description: Path to Kubernetes manifests
      default: manifests/
      required: true
    timeout:
      type: number
      description: Deployment timeout in minutes
      default: 10
      required: false

  steps:
    - name: Validate Manifests
      description: Validate Kubernetes manifests
    - name: Deploy to Kubernetes
      description: Deploy application to Kubernetes cluster
    - name: Verify Deployment
      description: Verify the deployment was successful

examples:
  - |
    # Example usage in pipeline
    stages:
      - stage:
          template:
            name: Kubernetes Deployment Stage
            identifier: kubernetes_deployment_stage
            versionLabel: 1.2.0
          variables:
            namespace: production
            serviceAccount: deploy-sa
          parameters:
            manifests: k8s/production/
            timeout: 15
